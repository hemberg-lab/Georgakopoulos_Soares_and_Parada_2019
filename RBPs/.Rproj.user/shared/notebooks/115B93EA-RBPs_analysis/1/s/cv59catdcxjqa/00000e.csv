"0","library(ggalluvial)"
"0","library(plyr)"
"0","clustering.non_template <- hclust(dist(matrix.non_template), method = ""ward.D"")"
"0","clusters.non_template <- cutree(clustering.non_template, k=8)"
"0","clustering.template <- hclust(dist(matrix.template), method = ""ward.D"")"
"0","clusters.template <- cutree(clustering.template, k=8)"
"0","clustering.total <-  as.data.frame(cbind(clusters.non_template, clusters.template = clusters.template[names(clusters.non_template)]))"
"0","clustering.total$clusters.non_template <- mapvalues(clustering.total$clusters.non_template , "
"0","          from =1:8,"
"0","          to = c(""ns2"", ""iB2"", ""iB1"", ""iBsU"", ""ns1"", ""ieB2"", ""ieB1"", ""iBsD""))"
"0","clustering.total$clusters.template <- mapvalues(clustering.total$clusters.template , "
"0","          from =1:8,"
"0","          to = c(""ns1"", ""ns2"", ""ieB2"", ""iB1"", ""iB2"", ""iBsU"", ""iBsD"", ""ieB1""))"
"0","clustering.total$sample <- rownames(clustering.total)"
"0","clustering.total <- data.table(clustering.total)"
"0","clustering.total.stats <- clustering.total[ , .N , by =c(""clusters.non_template"", ""clusters.template"")]"
"0","ggplot(clustering.total.stats, aes(y=N, axis1=clusters.non_template, axis2=clusters.template)) +"
"0","  geom_alluvium( width = 1/12) +"
"0","  geom_stratum(width = 1/12, fill = ""black"", color = ""grey"") +"
"0","  geom_label(stat = ""stratum"", label.strata = TRUE) +"
"0","  scale_x_discrete(limits = c(""clusters.non_template"", ""clusters.template""), expand = c(.05, .05))"

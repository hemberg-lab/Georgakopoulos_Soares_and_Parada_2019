"0","plot_density_binomial_RBP <- function(up_plus, up_minus, down_plus, down_minus, observations_up, observations_down, sig){"
"0","  "
"0","  up_TOTAL <-  merge(up_plus, up_minus, by=""Position"")"
"0","  up_TOTAL[,Occurrences:=Occurrences.x+Occurrences.y]"
"0","  up_TOTAL[,Occurrences:=Occurrences.x+Occurrences.y]"
"0","  "
"0","  "
"0","  "
"0","  up_TOTAL <- cbind(up_TOTAL, up_TOTAL[, binconf(Occurrences, observations_up, alpha=sig) ])"
"0","  up_TOTAL[,median:=median(PointEst)]"
"0","  up_TOTAL[, Enrrichment:=PointEst/median]"
"0","  up_TOTAL[, Enrrichment_l:=Lower/median]"
"0","  up_TOTAL[, Enrrichment_u:=Upper/median]"
"0","  up_TOTAL[, Position:=Position-1]"
"0","  "
"0","  "
"0","  down_TOTAL <-  merge(down_plus, down_minus, by=""Position"")"
"0","  down_TOTAL[,Occurrences:=Occurrences.x+Occurrences.y]"
"0","  "
"0","  down_TOTAL <- cbind(down_TOTAL, down_TOTAL[, binconf(Occurrences, observations_down, alpha=sig) ])"
"0","  down_TOTAL[,median:=median(PointEst)]"
"0","  down_TOTAL[, Enrrichment:=PointEst/median]"
"0","  down_TOTAL[, Enrrichment_l:=Lower/median]"
"0","  down_TOTAL[, Enrrichment_u:=Upper/median]"
"0","  down_TOTAL[, Position:=Position-1]  "
"0","  "
"0","  "
"0","  up_TOTAL[ ,exon_pos:=""Upstream""]"
"0","  down_TOTAL[ ,exon_pos:=""Downstream""]"
"0","  "
"0","  TOTAL <- rbind(up_TOTAL, down_TOTAL)"
"0","  "
"0","  TOTAL$exon_pos <-  factor(TOTAL$exon_pos, levels=c(""Upstream"", ""Downstream"" )) "
"0","  "
"0","  p <- ggplot(TOTAL)+"
"0","    geom_line(aes(x=Position,y=Enrrichment)) +"
"0","    geom_ribbon(aes(ymin=Enrrichment_l, ymax=Enrrichment_u, x=Position), alpha=0.3 )+"
"0","    facet_grid( . ~ exon_pos ) +"
"0","    theme_bw()"
"0","  "
"0","  #show(p)"
"0","  "
"0","  return(TOTAL) "
"0","  "
"0","}"
